<!DOCTYPE html>
<html lang="en" data-color-scheme="light">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>FRA Atlas - AI-Powered WebGIS Decision Support System</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<link rel="stylesheet" href="/style.css">
	<style>
		/* Hide legacy navbar when embedded */
		body.legacy-hide-nav .navbar { display: none !important; }
	</style>
</head>
<body>
	<div id="__legacy-root"></div>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script>
	(function() {
		function loadScript(src) {
			return new Promise(function(resolve, reject) {
				var s = document.createElement('script');
				s.src = src;
				s.onload = resolve;
				s.onerror = reject;
				document.body.appendChild(s);
			});
		}
		function applyHashRouting() {
			var section = (location.hash || '#dashboard').replace('#', '');
			if (typeof window.showSection === 'function') {
				window.showSection(section);
				var link = document.querySelector('[data-section="' + section + '"]');
				if (link) {
					document.querySelectorAll('[data-section]').forEach(function(n){ n.classList.remove('active'); });
					link.classList.add('active');
				}
			}
		}
		// If embedded in an iframe, hide the legacy navbar
		if (window.top !== window.self) {
			document.addEventListener('DOMContentLoaded', function(){
				document.body.classList.add('legacy-hide-nav');
			});
		}
		fetch('/legacy.html', { cache: 'no-store' })
			.then(function(r) { if (!r.ok) throw new Error('failed to load legacy.html'); return r.text(); })
			.then(function(html) {
				document.getElementById('__legacy-root').innerHTML = html;
			})
			.then(function() { return loadScript('/app.js'); })
			.then(function() {
				applyHashRouting();
				window.addEventListener('hashchange', applyHashRouting);
			})
			.catch(function(e) { console.error('Legacy bootstrap failed:', e); });
	})();
	</script>
</body>
</html> 